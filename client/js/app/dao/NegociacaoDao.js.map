{"version":3,"sources":["../../app-es6/dao/NegociacaoDao.js"],"names":["Negociacao","NegociacaoDao","connection","_connection","_store","negociacao","Promise","resolve","reject","request","transaction","objectStore","add","onsuccess","event","onerror","console","log","target","error","negociacoes","cursor","openCursor","current","result","neg","value","push","_data","_quantidade","_valor","continue","clear"],"mappings":";;;;;;;;;;;;;;;AAAQA,gB,qBAAAA,U;;;;;;;;;;;;;;;;;;;;;+BAEKC,a;AAEX,+BAAYC,UAAZ,EAAwB;AAAA;;AACtB,eAAKC,WAAL,GAAmBD,UAAnB;AACA,eAAKE,MAAL,GAAc,aAAd;AACD;;;;oCAESC,U,EAAY;AAAA;;AACpB,mBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;;AAEtC,kBAAIC,UAAU,MAAKN,WAAL,CAAiBO,WAAjB,CAA6B,CAAC,MAAKN,MAAN,CAA7B,EAA4C,WAA5C,EAAyDO,WAAzD,CAAqE,MAAKP,MAA1E,EAAkFQ,GAAlF,CAAsFP,UAAtF,CAAd;;AAEAI,sBAAQI,SAAR,GAAoB,UAACC,KAAD;AAAA,uBAAWP,QAAQF,UAAR,CAAX;AAAA,eAApB;;AAEAI,sBAAQM,OAAR,GAAkB,UAACD,KAAD,EAAW;AAC3BE,wBAAQC,GAAR,CAAY,uCAAZ,EAAqDH,MAAMI,MAAN,CAAaC,KAAlE;AACAX,uBAAO,wCAAP;AACD,eAHD;AAID,aAVM,CAAP;AAWD;;;wCAEa;AAAA;;AACZ,mBAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;;AAEtC,kBAAIY,cAAc,EAAlB;AACA,kBAAIC,SAAS,OAAKlB,WAAL,CAAiBO,WAAjB,CAA6B,CAAC,OAAKN,MAAN,CAA7B,EAA4C,UAA5C,EAAwDO,WAAxD,CAAoE,OAAKP,MAAzE,EAAiFkB,UAAjF,EAAb;;AAEAD,qBAAOR,SAAP,GAAmB,UAACC,KAAD,EAAW;AAC5B,oBAAIS,UAAUT,MAAMI,MAAN,CAAaM,MAA3B;AACA,oBAAI,CAACD,OAAL,EAAc;AACZhB,0BAAQa,WAAR;AACA;AACD;AACD,oBAAIK,MAAMF,QAAQG,KAAlB;AACAN,4BAAYO,IAAZ,CAAiB,IAAI3B,UAAJ,CAAeyB,IAAIG,KAAnB,EAA0BH,IAAII,WAA9B,EAA2CJ,IAAIK,MAA/C,CAAjB;AACAP,wBAAQQ,QAAR;AACD,eATD;;AAWAV,qBAAON,OAAP,GAAiB,UAACD,KAAD,EAAW;AAC1BE,wBAAQC,GAAR,CAAY,uCAAZ,EAAqDH,MAAMI,MAAN,CAAaC,KAAlE;AACAX,uBAAO,uCAAP;AACD,eAHD;AAID,aApBM,CAAP;AAqBD;;;wCAEa;AAAA;;AACZ,mBAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;;AAEtC,kBAAIC,UAAU,OAAKN,WAAL,CAAiBO,WAAjB,CAA6B,CAAC,OAAKN,MAAN,CAA7B,EAA4C,WAA5C,EAAyDO,WAAzD,CAAqE,OAAKP,MAA1E,EAAkF4B,KAAlF,EAAd;;AAEEvB,sBAAQI,SAAR,GAAoB,UAACC,KAAD;AAAA,uBAAWP,QAAQ,oCAAR,CAAX;AAAA,eAApB;AACAE,sBAAQM,OAAR,GAAkB,UAACD,KAAD,EAAW;AAC3BE,wBAAQC,GAAR,CAAY,yCAAZ,EAAuDH,MAAMI,MAAN,CAAaC,KAApE;AACAX,uBAAO,0CAAP;AACD,eAHD;AAIH,aATM,CAAP;AAUD","file":"NegociacaoDao.js","sourcesContent":["import {Negociacao} from '../models/Negociacao';\r\n\r\nexport class NegociacaoDao {\r\n\r\n  constructor(connection) {\r\n    this._connection = connection;\r\n    this._store = 'negociacoes';\r\n  }\r\n\r\n  adicionar(negociacao) {\r\n    return new Promise((resolve, reject) => {\r\n      \r\n      let request = this._connection.transaction([this._store], 'readwrite').objectStore(this._store).add(negociacao);\r\n      \r\n      request.onsuccess = (event) => resolve(negociacao);\r\n      \r\n      request.onerror = (event) => {\r\n        console.log('Não foi possível incluir a negociação', event.target.error);\r\n        reject('Não foi possível incluir a negociação.');\r\n      };\r\n    });\r\n  }\r\n\r\n  listarTodos() {\r\n    return new Promise((resolve, reject) => {\r\n      \r\n      let negociacoes = [];\r\n      let cursor = this._connection.transaction([this._store], 'readonly').objectStore(this._store).openCursor();      \r\n\r\n      cursor.onsuccess = (event) => {        \r\n        let current = event.target.result;        \r\n        if (!current) {\r\n          resolve(negociacoes);\r\n          return;\r\n        }        \r\n        let neg = current.value;        \r\n        negociacoes.push(new Negociacao(neg._data, neg._quantidade, neg._valor));        \r\n        current.continue();\r\n      }\r\n\r\n      cursor.onerror = (event) => {\r\n        console.log('Não foi possível obter as negociações', event.target.error);\r\n        reject('Não foi possível obter as negociações');\r\n      };\r\n    })\r\n  }\r\n\r\n  apagarTodos() {\r\n    return new Promise((resolve, reject) => {\r\n\r\n      let request = this._connection.transaction([this._store], 'readwrite').objectStore(this._store).clear();\r\n      \r\n        request.onsuccess = (event) => resolve('Negociações removidas com sucesso.');\r\n        request.onerror = (event) => {\r\n          console.log('Não foi possível remover as negociações', event.target.error);\r\n          reject('Não foi possível remover as negociações.')\r\n        };\r\n    });\r\n  }\r\n}"]}